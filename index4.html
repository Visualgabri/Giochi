<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Giochi di Chris e Julie</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    /* --- STILE --- */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: system-ui, sans-serif;
      background: linear-gradient(135deg, #fce4ec, #e3f2fd);
      padding: 20px; display: flex; flex-direction: column; align-items: center;
    }
    .container { width: 100%; max-width: 1000px; }
    header { text-align: center; margin-bottom: 30px; }
    h1 { color: #283593; font-size: 2.5rem; }
    .status { background: white; padding: 10px 20px; border-radius: 20px; font-size: 0.9rem; margin-bottom: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    
    /* Griglie e Card */
    .category-section { margin-bottom: 40px; }
    .category-title { font-size: 1.8rem; color: #1565c0; margin-bottom: 15px; border-bottom: 3px solid #bbdefb; padding-bottom: 5px; }
    .games-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 20px; }
    
    .game-card {
      background: white; border-radius: 15px; padding: 15px; text-align: center;
      box-shadow: 0 4px 6px rgba(0,0,0,0.05); transition: 0.3s; border: 1px solid #e0e0e0;
      position: relative; display: flex; flex-direction: column; gap: 10px;
    }
    .game-card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
    
    .badge-new {
      position: absolute; top: -10px; right: -10px; background: #ff5252; color: white;
      padding: 5px 10px; border-radius: 10px; font-size: 0.7rem; font-weight: bold; transform: rotate(15deg);
    }
    
    .game-icon { font-size: 40px; }
    .game-title { font-weight: bold; color: #333; height: 40px; display: flex; align-items: center; justify-content: center; }
    .game-date { font-size: 0.75rem; color: #888; }
    
    .play-button {
      background: #1976d2; color: white; text-decoration: none; padding: 10px;
      border-radius: 10px; font-weight: bold; margin-top: auto;
    }
    .play-button:hover { background: #1565c0; }
  </style>
</head>
<body>

<div class="container">
  <header>
    <h1>üß∏ La Stanza dei Giochi</h1>
    <p>Christopher & Julie</p>
    <div id="status" class="status">Caricamento giochi...</div>
  </header>

  <main id="main-content"></main>
</div>

<script>
  const emojis = ["üéÆ", "üöÄ", "ü¶Ñ", "üêØ", "üéà", "üé®", "üß©", "‚≠ê", "üêº", "üéØ"];
  
  async function loadGames() {
    try {
      // Carichiamo il file JSON creato dallo script update.js
      const response = await fetch('games-data.json');
      if (!response.ok) throw new Error("File 'games-data.json' non trovato!");
      const games = await response.json();

      const mainContent = document.getElementById('main-content');
      mainContent.innerHTML = '';

      // Raggruppiamo per categoria
      const categories = {};
      games.forEach(game => {
        if (!categories[game.category]) categories[game.category] = [];
        categories[game.category].push(game);
      });

      // Creiamo le sezioni
      Object.keys(categories).forEach((cat, index) => {
        const section = document.createElement('section');
        section.className = 'category-section';
        
        let icon = "üìÇ";
        if (cat.toLowerCase() === 'chris') icon = "üêØ";
        if (cat.toLowerCase() === 'julie') icon = "ü¶Ñ";

        section.innerHTML = `<h2 class="category-title">${icon} ${cat}</h2>`;
        
        const grid = document.createElement('div');
        grid.className = 'games-grid';

        categories[cat].forEach((game, i) => {
          const isNew = i < 3 && index === 0; // Segna come nuovi i primi 3 dell'intera lista
          const date = new Date(game.createdAt).toLocaleDateString('it-IT');
          
          const card = document.createElement('div');
          card.className = 'game-card';
          card.innerHTML = `
            ${isNew ? '<div class="badge-new">NUOVO!</div>' : ''}
            <div class="game-icon">${emojis[game.name.length % emojis.length]}</div>
            <div class="game-title">${game.name.replace('.html', '').replace(/_/g, ' ')}</div>
            <div class="game-date">Aggiunto: ${date}</div>
            <a href="${game.path}" class="play-button" target="_blank">GIOCA</a>
          `;
          grid.appendChild(card);
        });

        section.appendChild(grid);
        mainContent.appendChild(section);
      });

      document.getElementById('status').textContent = `Trovati ${games.length} giochi ordinati per data!`;

    } catch (err) {
      document.getElementById('status').textContent = "Errore: " + err.message;
      document.getElementById('status').style.color = "red";
    }
  }

  loadGames();
</script>
</body>
</html>